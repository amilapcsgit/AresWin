<Window x:Class="AresWin.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="SETTINGS GAUGE" Height="500" Width="380"
        Background="{DynamicResource PanelBackgroundBrush}" Foreground="{DynamicResource TextPrimaryBrush}"
        WindowStyle="None" AllowsTransparency="False"
        ResizeMode="CanResize" WindowStartupLocation="CenterOwner"
        BorderThickness="1"
        MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
    <Window.BorderBrush>
        <SolidColorBrush Color="#004488"/>
    </Window.BorderBrush>
    
    <Window.Resources>
        <!-- Theme accents / defaults (MainWindow will override Application resources at runtime) -->
        <SolidColorBrush x:Key="TronCyan" Color="#00EAFF"/>
        <SolidColorBrush x:Key="TronOrange" Color="#FF9900"/>
        <SolidColorBrush x:Key="TronRed" Color="#FF003C"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="#8899AA"/>
        <DropShadowEffect x:Key="GlowCyan" Color="#00EAFF" BlurRadius="8" ShadowDepth="0" Opacity="0.9"/>
        <DropShadowEffect x:Key="GlowOrange" Color="#FF9900" BlurRadius="8" ShadowDepth="0" Opacity="0.9"/>

        <!-- keep fallback brush keys local so window loads even if app resources are not yet set -->
        <SolidColorBrush x:Key="ControlBackgroundBrush" Color="#050B1A"/>
        <SolidColorBrush x:Key="ControlForegroundBrush" Color="#00EAFF"/>
        <SolidColorBrush x:Key="ComboBoxBackgroundBrush" Color="#050B1A"/>
        <SolidColorBrush x:Key="ComboBoxForegroundBrush" Color="#00EAFF"/>
        <SolidColorBrush x:Key="ComboBoxBorderBrush" Color="#004488"/>

        <!-- ComboBox item container styling (ensures popup items follow theme) -->
        <Style TargetType="ComboBoxItem" x:Key="ComboBoxItem_Themed">
            <Setter Property="Foreground" Value="{DynamicResource ComboBoxForegroundBrush}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Padding" Value="6,4"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="{DynamicResource TronCyan}"/>
                    <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{DynamicResource PanelBackgroundBrush}"/>
                    <Setter Property="Foreground" Value="{DynamicResource ComboBoxForegroundBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Simple ComboBox control template that applies DynamicResources to toggle and popup background -->
        <Style TargetType="ComboBox" x:Key="ComboBox_Themed">
            <Setter Property="Background" Value="{DynamicResource ComboBoxBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource ComboBoxForegroundBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ComboBoxBorderBrush}"/>
            <Setter Property="Padding" Value="6,2"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton x:Name="ToggleButton"
                                          Focusable="False"
                                          IsChecked="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}"
                                          Background="{TemplateBinding Background}"
                                          BorderBrush="{TemplateBinding BorderBrush}"
                                          BorderThickness="{TemplateBinding BorderThickness}"
                                          HorizontalAlignment="Stretch"
                                          VerticalAlignment="Center">
                                <Grid>
                                    <ContentPresenter x:Name="ContentSite"
                                                      IsHitTestVisible="False"
                                                      Content="{TemplateBinding SelectionBoxItem}"
                                                      ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                                      Margin="6,0,24,0"
                                                      VerticalAlignment="Center"
                                                      HorizontalAlignment="Left"
                                                      RecognizesAccessKey="True"/>
                                    <Path x:Name="Arrow" HorizontalAlignment="Right" Margin="0,0,8,0" VerticalAlignment="Center" Data="M 0 0 L 8 0 L 4 5 Z" Fill="{DynamicResource ComboBoxForegroundBrush}" />
                                </Grid>
                            </ToggleButton>

                            <Popup x:Name="Popup"
                                   Placement="Bottom"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   IsOpen="{TemplateBinding IsDropDownOpen}"
                                   PopupAnimation="Fade">
                                <Border Background="{DynamicResource ComboBoxBackgroundBrush}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="2"
                                        SnapsToDevicePixels="True"
                                        Padding="0">
                                    <ScrollViewer CanContentScroll="True" MinWidth="{TemplateBinding ActualWidth}">
                                        <StackPanel IsItemsHost="True"/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="HasItems" Value="False">
                                <Setter TargetName="Popup" Property="Visibility" Value="Collapsed"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Foreground" Value="{DynamicResource ComboBoxForegroundBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="ItemContainerStyle" Value="{StaticResource ComboBoxItem_Themed}"/>
        </Style>

        <!-- CYAN BUTTON -->
        <Style x:Key="Style_Btn_Cyan" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TronCyan}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource TronCyan}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="3"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Effect" Value="{StaticResource GlowCyan}"/>
                                <Setter TargetName="border" Property="Background" Value="{DynamicResource PanelBackgroundBrush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{DynamicResource TronCyan}"/>
                                <Setter Property="Foreground" Value="{DynamicResource PanelBackgroundBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- RED BUTTON -->
        <Style x:Key="Style_Btn_Red" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TronRed}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource TronRed}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="3"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Effect" Value="{StaticResource GlowCyan}"/>
                                <Setter TargetName="border" Property="Background" Value="{DynamicResource PanelBackgroundBrush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{DynamicResource TronRed}"/>
                                <Setter Property="Foreground" Value="{DynamicResource PanelBackgroundBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- TOGGLE CYAN -->
        <Style x:Key="Style_Toggle_Cyan" TargetType="ToggleButton">
            <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TronCyan}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource TronCyan}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="border" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Effect" Value="{StaticResource GlowCyan}"/>
                                <Setter TargetName="border" Property="Background" Value="{DynamicResource PanelBackgroundBrush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{DynamicResource PanelBackgroundBrush}"/>
                                <Setter TargetName="border" Property="Effect" Value="{StaticResource GlowCyan}"/>
                                <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- TOGGLE ORANGE -->
        <Style x:Key="Style_Toggle_Orange" TargetType="ToggleButton">
            <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TronOrange}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource TronOrange}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="border" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Effect" Value="{StaticResource GlowOrange}"/>
                                <Setter TargetName="border" Property="Background" Value="{DynamicResource PanelBackgroundBrush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{DynamicResource PanelBackgroundBrush}"/>
                                <Setter TargetName="border" Property="Effect" Value="{StaticResource GlowOrange}"/>
                                <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Background="{DynamicResource PanelBackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="45"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- TITLE BAR (wrapped in Border for stroke) -->
        <Border Grid.Row="0" Background="{DynamicResource PanelBackgroundBrush}" BorderBrush="{DynamicResource PanelBorderBrush}" BorderThickness="0,0,0,1">
            <Grid x:Name="TitleBar">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Text="SETTINGS GAUGE" Foreground="{DynamicResource TronCyan}" FontWeight="Bold" FontSize="14" VerticalAlignment="Center" Margin="12,0,0,0" FontFamily="Consolas"/>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,5,0">
                    <Button x:Name="btnMin" Style="{StaticResource Style_Btn_Cyan}" Content="_" Width="28" Height="28" VerticalContentAlignment="Bottom" FontWeight="Bold" Click="btnMin_Click" Margin="2"/>
                    <Button x:Name="btnMax" Style="{StaticResource Style_Btn_Cyan}" Width="28" Height="28" Click="btnMax_Click" Margin="2">
                        <Rectangle Width="10" Height="10" Stroke="{DynamicResource TronCyan}" StrokeThickness="2"/>
                    </Button>
                    <Button x:Name="btnClose" Style="{StaticResource Style_Btn_Red}" Width="28" Height="28" Click="btnClose_Click" Margin="2">
                        <Path Data="M 0,0 L 8,8 M 8,0 L 0,8" Stroke="{DynamicResource TextPrimaryBrush}" StrokeThickness="2"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- CONTENT -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="12">
            <StackPanel>
                <TextBlock Text="THEME" Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" Margin="0,0,0,4"/>
                <ComboBox x:Name="ThemeSelector" SelectionChanged="ThemeSelector_SelectionChanged" Height="28" Margin="0,0,0,12"
                          Style="{StaticResource ComboBox_Themed}">
                    <ComboBoxItem Content="ARES (TRON)" Tag="Ares"/>
                    <ComboBoxItem Content="WINDOWS DARK" Tag="WindowsDark"/>
                    <ComboBoxItem Content="WINDOWS LIGHT" Tag="WindowsLight"/>
                </ComboBox>

                <TextBlock Text="ACCENT COLOR" Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" Margin="0,0,0,4"/>
                <ComboBox x:Name="AccentSelector" SelectionChanged="AccentSelector_SelectionChanged" Height="28" Margin="0,0,0,12"
                          Style="{StaticResource ComboBox_Themed}">
                    <ComboBoxItem Content="CYAN" Tag="#00EAFF"/>
                    <ComboBoxItem Content="ORANGE" Tag="#FF9900"/>
                    <ComboBoxItem Content="GREEN" Tag="#00FF6A"/>
                    <ComboBoxItem Content="RED" Tag="#FF003C"/>
                </ComboBox>

                <TextBlock Text="AUTO SCAN" Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" Margin="0,0,0,4"/>
                <ToggleButton x:Name="btnAutoScan" Content="AUTO SCAN ENABLED" IsChecked="True" Style="{StaticResource Style_Toggle_Cyan}" Height="32" Click="btnAutoScan_Click" Margin="0,0,0,12"/>

                <TextBlock Text="MATRIX LAYER" Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" Margin="0,0,0,4"/>
                <ToggleButton x:Name="btnMatrixVisible" Content="MATRIX VISIBLE" IsChecked="True" Style="{StaticResource Style_Toggle_Cyan}" Height="32" Click="btnMatrixVisible_Click" Margin="0,0,0,8"/>
                <ToggleButton x:Name="btnMatrixAnim" Content="MATRIX ANIMATION ON" IsChecked="True" Style="{StaticResource Style_Toggle_Orange}" Height="32" Click="btnMatrixAnim_Click" Margin="0,0,0,12"/>

                <TextBlock Text="MATRIX SPEED" Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" Margin="0,0,0,4"/>
                <Slider x:Name="sliderMatrixSpeed" Minimum="0.4" Maximum="2.0" Value="1.0" TickFrequency="0.2" IsSnapToTickEnabled="True" ValueChanged="sliderMatrixSpeed_ValueChanged"/>
                <TextBlock x:Name="txtMatrixSpeed" Text="1.0x" Foreground="{DynamicResource TronCyan}" FontSize="12" Margin="0,6,0,20" HorizontalAlignment="Right"/>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>